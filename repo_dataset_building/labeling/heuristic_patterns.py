CWE_PATTERNS = {
    "CWE-79": [
        r"response\.getWriter\(\)",
        r"<script>",
        r"request\.getParameter",
        r"out\.println\(",
        r"\.append\(",
        r"\.write\(",
        r"getQueryString\(",
    ],
    "CWE-89": [
        r"Statement\s+\w+\s*=\s*conn\.createStatement",
        r"execute(Query|Update)\s*\(.*\+.*\)",
        r"SELECT\s+\*\s+FROM.*\+.*",
        r"prepareStatement\(.*\+.*\)",
        r"\".*SELECT.*\"\s*\+",
    ],
    "CWE-22": [
        r"File\s*\(\s*.*request\.getParameter",
        r"\.\./",
        r"getRealPath\(",
        r"Paths\.get\(.*\+.*\)",
        r"FileInputStream\s*\(.*\+.*\)",
    ],
    "CWE-502": [
        r"ObjectInputStream",
        r"readObject\(",
        r"deserialize\(",
        r"XMLDecoder",
        r"readExternal\(",
    ],
    "CWE-327": [
        r"MessageDigest\.getInstance\(\"MD5",
        r"MessageDigest\.getInstance\(\"SHA1",
        r"Cipher\.getInstance\(\"RC4",
        r"Cipher\.getInstance\(\"DES",
        r"Cipher\.getInstance\(\"AES/ECB",
        r"Cipher\.getInstance\(\"AES/CFB",
        r"Cipher\.getInstance\(\"AES/OFB",
        r"Cipher\.getInstance\(\"Blowfish",
        r"Cipher\.getInstance\(\"TripleDES",
        r"Cipher\.getInstance\(\"RSA/ECB",
        r"KeyGenerator\.getInstance\(\"DES",
        r"KeyGenerator\.getInstance\(\"RC4",
        r"KeyPairGenerator\.getInstance\(\"DSA",
    ],
    "CWE-798": [
        r"password\s*=\s*\"[^\"]+\"",
        r"setPassword\s*\(\s*\"[^\"]+\"",
        r"setCredentials\s*\(\s*\"[^\"]+\"",
        r"key\s*=\s*\"[^\"]+\"",
        r"api[_\-]?key\s*=\s*\"[^\"]+\"",
        r"secret\s*=\s*\"[^\"]+\"",
        r"access[_\-]?token\s*=\s*\"[^\"]+\"",
        r"client[_\-]?secret\s*=\s*\"[^\"]+\"",
        r"System\.setProperty\s*\(\s*\".*password",
    ],
    "CWE-311": [
        r"new URL\(\"http://",
        r"URLConnection\s+\w+\s*=\s*url\.openConnection",
        r"HttpURLConnection",
        r"openConnection\(",
        r"RestTemplate\.getForObject\(",
    ],
    "CWE-732": [
        r"setReadable\(true.*false\)",
        r"setWritable\(true.*false\)",
        r"chmod\s*\(.*0777",
        r"Files\.setPosixFilePermissions",
    ],
    "CWE-200": [
        r"printStackTrace\(",
        r"System\.out\.println\(",
        r"e\.getMessage\(",
        r"logger\.debug",
        r"log\.warn",
        r"e\.printStackTrace\(",
    ],
    "CWE-269": [
        r"checkPermission",
        r"AccessController",
        r"setAccessible\(true\)",
        r"SecurityManager",
    ],
    "CWE-862": [
        r"if\s*\(!isAuthenticated\(\)",
        r"if\s*\(!user\.isAuthorized",
        r"request\.getUserPrincipal\(",
        r"isUserInRole\(",
        r"session\.getAttribute\(\"role",
    ],
    "CWE-287": [
        r"login\(",
        r"authenticate\(",
        r"auth\s*=\s*null",
        r"session\.getAttribute\(\"user",
        r"user\s*==\s*null",
    ],
    "CWE-330": [
        r"new\s+Random\(",
        r"Math\.random\(",
        r"SecureRandom\.setSeed",
        r"Random\.next(Int|Boolean|Bytes|Double|Float)",
    ],
    "CWE-312": [
        r"FileOutputStream.*\.write\(",
        r"BufferedWriter.*\.write\(",
        r"PrintWriter.*\.write\(",
        r"System\.out\.print.*password",
    ],
    "CWE-329": [
        r"Cipher\.getInstance\(\"AES\"",
        r"Cipher\.getInstance\(\"RSA\"",
    ],
    "CWE-611": [
        r"DocumentBuilderFactory\.newInstance",
        r"setFeature\(.*external.*true",
        r"SAXParserFactory",
        r"XMLReader",
        r"DocumentBuilder",
    ],
    "CWE-918": [
        r"new URL\(",
        r"httpURLConnection",
        r"openConnection\(",
        r"httpClient\.execute",
        r"RestTemplate\.getForObject",
    ],
    "CWE-78": [
        r"Runtime\.getRuntime\(\)\.exec\(",
        r"ProcessBuilder",
        r"exec\(.+\+.+\)",
        r"cmd\.exe",
        r"/bin/sh",
    ],
    "CWE-400": [
        r"while\s*\(true\)",
        r"for\s*\(;;\)",
        r".*Pattern\.compile\(",
        r"Thread\.sleep\(",
        r"Collections\.sort\(",
    ],
}
